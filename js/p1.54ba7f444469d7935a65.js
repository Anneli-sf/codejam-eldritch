(()=>{"use strict";const e={en:{greetTr:"Good ",plHolderTr:"enter your name",timesOfDayTr:["night","morning","afternoon","evening"],langTr:"en-US",cityTr:"Minsk",cityPlaceHolderTr:"enter the city",windTr:"wind",humidityTr:"humidity",chooseLangTr:"choose language",chooseSourceTr:"choose photo source",enterBgTemeTr:"background theme",bgPlaceHolderTr:"enter theme",timeTr:"time",dateTr:"date",greetingTr:"greeting",quoteTr:"quote",weatherTr:"weather",audioTr:"audio player",todoTr:"todo",activeTr:"active",completedTr:"completed",deletedTr:"deleted"},ru:{greetTr:"Добр",plHolderTr:"введите ваше имя",timesOfDayTr:["ой ночи","е утро","ый день","ый вечер"],langTr:"ru-RU",cityTr:"Минск",cityPlaceHolderTr:"введите город",windTr:"ветер",humidityTr:"влажность воздуха",chooseLangTr:"выберите язык",chooseSourceTr:"выберите источник фона",enterBgTemeTr:"тема фона",bgPlaceHolderTr:"введите тему",timeTr:"время",dateTr:"дата",greetingTr:"приветствие",quoteTr:"цитата",weatherTr:"погода",audioTr:"аудио плейер",todoTr:"список дел",activeTr:"активные",completedTr:"выполненные",deletedTr:"удалённые"}},t=document.querySelector(".name"),o=document.querySelector(".greeting"),n={value:"en"};function c(n){const c=r(n),a=`${e[n].greetTr}${c}, `;return t.placeholder=`${e[n].plHolderTr}`,o.textContent=a}function r(t){const o=(new Date).getHours(),n=Math.floor(o/6);return e[t].timesOfDayTr.reduce(((e,t,o)=>(o==n&&(e=t),e)))}const a=document.querySelector(".date");function l(t){const o=(new Date).toLocaleDateString(`${e[t].langTr}`,{weekday:"long",month:"long",day:"numeric"});a.textContent=o}function s(e,t){return e=Math.ceil(e),t=Math.floor(t),Math.floor(Math.random()*(t-e+1))+e}const d=document.querySelector(".weather-icon"),i=document.querySelector(".temperature"),u=document.querySelector(".weather-description"),m=document.querySelector(".wind"),g=document.querySelector(".humidity"),y=document.querySelector(".city"),h=document.querySelector(".weather-error");async function S(t){localStorage.getItem("city")?y.value=localStorage.getItem("city"):y.value=`${e[t].cityTr}`,console.log("weather city",y.value);const o=`https://api.openweathermap.org/data/2.5/weather?q=${y.value}&lang=${t}&appid=3d3089a958d144a6b08451c705f4ef59&units=metric`,n=await fetch(o),c=await n.json();404==n.status?(h.textContent="Error: city isn't found",i.textContent="",m.textContent="",g.textContent=""):400==n.status?(h.textContent="Error: enter the city",i.textContent="",m.textContent="",g.textContent=""):h.textContent="",y.placeholder=`${e[t].cityPlaceHolderTr}`,d.className="weather-icon owf",d.classList.add(`owf-${c.weather[0].id}`),i.textContent=`${Math.floor(c.main.temp)} °C`,u.textContent=c.weather[0].description,m.textContent=`${e[t].windTr}: ${Math.floor(c.wind.speed)} m/s`,g.textContent=`${e[t].humidityTr}: ${Math.floor(c.main.humidity)} %`}const v=document.querySelector(".quote"),p=document.querySelector(".author");async function T(e){const t=await fetch("quotes.json"),o=await t.json();let n=s(1,29);v.textContent=`${o[e][n].text}`,p.textContent=`${o[e][n].author}`}const q=[{title:"Aqua Caelestis",src:"../images/sounds/AquaCaelestis.mp3",duration:"00:58"},{title:"River Flows In You",src:"../images/sounds/RiverFlowsInYou.mp3",duration:"03:50"},{title:"Ennio Morricone",src:"../images/sounds/EnnioMorricone.mp3",duration:"03:50"},{title:"Summer Wind",src:"../images/sounds/SummerWind.mp3",duration:"03:50"}],f=document.querySelector(".play"),L=document.querySelector(".play-next"),w=document.querySelector(".play-prev"),x=document.querySelector(".play-list"),$=new Audio;let k=!1,C=0;function E(){$.currentTime=0,$.play(),k=!0}function b(){const e=document.querySelectorAll(".play-item");e.forEach((e=>e.classList.remove("active"))),C==q.length-1?C=0:C+=1,$.src=q[C].src,e[C].classList.add("active"),E(),f.classList.contains("play")&&f.classList.add("pause")}q.forEach(((e,t)=>{(e=document.createElement("li")).classList.add("play-item"),e.textContent=`${q[t].title}`,x.appendChild(e)}));let I=0,H=0,M=0;const O=document.querySelector(".todo-button"),A=document.querySelector(".todo"),P=document.querySelector("#active-option"),_=document.querySelector("#deleted-option"),j=document.querySelector("#completed-option");const G={action(e){const t=e.target;if(t.classList.contains("todo-action")){const e=t.dataset.todoAction,o=t.closest(".todo-item");"deleted"===e&&"deleted"===o.dataset.todoState?o.remove():o.dataset.todoState=e,this.save()}else t.classList.contains("todo-add")&&(this.add(),this.save())},add(){const e=document.querySelector(".todo-text");!e.disabled&&e.value.length&&(document.querySelector(".todo-items").insertAdjacentHTML("beforeend",this.create(e.value)),e.value="")},create:e=>`<li class="todo-item" data-todo-state="active">\n  <span class="todo-task">${e}</span>\n  <span class="todo-action todo-action-restore" data-todo-action="active"></span>\n  <span class="todo-action todo-action-complete" data-todo-action="completed"></span>\n  <span class="todo-action todo-action-delete" data-todo-action="deleted"></span></li>`,init(){const e=localStorage.getItem("todo");e&&(document.querySelector(".todo-items").innerHTML=e),document.querySelector(".todo-options").addEventListener("change",this.update),document.addEventListener("click",this.action.bind(this))},update(){const e=document.querySelector(".todo-options").value;document.querySelector(".todo-items").dataset.todoOption=e,document.querySelector(".todo-text").disabled="active"!==e},save(){localStorage.setItem("todo",document.querySelector(".todo-items").innerHTML)}},N=document.querySelector(".settings"),D=document.querySelector(".settings-button"),U=document.querySelector(".change-language"),B=document.querySelector(".change-photosource"),R=document.querySelector(".choose-background"),Y=document.querySelector("#audio"),F=document.querySelector("#date"),W=document.querySelector("#time"),z=document.querySelector("#quote"),J=document.querySelector("#todo"),K=document.querySelector("#greeting"),Q=document.querySelector("#weather"),V=document.querySelector(".text-choose-language"),X=document.querySelector(".text-choose-photosource"),Z=document.querySelector(".text-choose-background"),ee=document.querySelector(".text-date"),te=document.querySelector(".text-time"),oe=document.querySelector(".text-greeting"),ne=document.querySelector(".text-quotes"),ce=document.querySelector(".text-weather"),re=document.querySelector(".text-audioplayer"),ae=document.querySelector(".text-todo"),le=document.querySelector(".player"),se=document.querySelector(".greeting-container"),de=document.querySelector(".footer-quotes"),ie=document.querySelector(".choose-option-background"),ue=document.querySelector(".weather"),me=document.querySelector(".time");let ge,ye=[Q,Y,F,W,z,J,K],he=[ue,le,a,me,de,O,se];function Se(){ye.forEach(((e,t)=>{e.addEventListener("change",(()=>{0==e.checked?he[t].classList.add("hidden"):he[t].classList.remove("hidden")}))}))}function ve(t){V.textContent=`${e[t].chooseLangTr}`,X.textContent=`${e[t].chooseSourceTr}`,Z.textContent=`${e[t].enterBgTemeTr}`,R.placeholder=`${e[t].bgPlaceHolderTr}`,ee.textContent=`${e[t].dateTr}`,te.textContent=`${e[t].timeTr}`,oe.textContent=`${e[t].greetingTr}`,ne.textContent=`${e[t].quoteTr}`,ce.textContent=`${e[t].weatherTr}`,re.textContent=`${e[t].audioTr}`,ae.textContent=`${e[t].todoTr}`}function pe(){localStorage.setItem("LANGUAGE_OPTION",U.value),localStorage.setItem("PHOTO_SOURCE_OPTION",B.value),localStorage.setItem("BG_THEME",R.value),localStorage.setItem("timeSet",W.checked),localStorage.setItem("dataSet",F.checked),localStorage.setItem("greetingSet",K.checked),localStorage.setItem("weatherSet",Q.checked),localStorage.setItem("quoteSet",z.checked),localStorage.setItem("audioSet",Y.checked),localStorage.setItem("todoSet",J.checked),localStorage.setItem("lang",n.value)}const Te=document.querySelector("body"),qe=document.querySelector(".slide-next"),fe=document.querySelector(".slide-prev"),Le=document.querySelector(".change-quote");let we,xe=s(1,20);function $e(){const e=(new Date).toLocaleTimeString("en-US",{hour12:!1});me.textContent=e,l(n.value),c(n.value),setTimeout($e,1e3)}async function ke(){const e=new Image;let t=r("en"),o=await async function(){let e=r("en"),t=s(1,50);ge=R.value?R.value:e,console.log("flickr bg theme start",ge);let o=`https://www.flickr.com/services/rest/?method=flickr.photos.search&api_key=99db50653f5b2b2c4dfe4766555f1d09&tags=${ge}&extras=url_l&format=json&nojsoncallback=1`;const n=await fetch(o);return(await n.json()).photos.photo[t].url_l}();switch(we=xe<10?xe.toString().padStart(2,0):xe.toString(),B.value){case"github":e.src=`https://raw.githubusercontent.com/rolling-scopes-school/stage1-tasks/assets/images/${t}/${we}.jpg`,ie.classList.remove("visible"),R.value="";break;case"unsplash":ie.classList.remove("visible");break;default:e.src=`${o}`,ie.classList.add("visible")}e.onload=()=>{Te.style.backgroundImage=`url(${e.src})`}}window.addEventListener("load",(function(){localStorage.getItem("LANGUAGE_OPTION")&&(U.value=localStorage.getItem("LANGUAGE_OPTION"),"en"==U.value?n.value="en":n.value="ru"),$e(),ke(),S(n.value),T(n.value),localStorage.getItem("name")&&(t.value=localStorage.getItem("name")),localStorage.getItem("city")&&(y.value=localStorage.getItem("city"))})),window.addEventListener("beforeunload",(()=>{localStorage.setItem("name",t.value)})),B.addEventListener("change",ke),R.addEventListener("change",(()=>{console.log("flickr bg theme in input",R.value),ke(),pe()})),qe.addEventListener("click",(function(){xe+=1,21==xe&&(xe=1),ke(),console.log("number of slide is",xe)})),fe.addEventListener("click",(function(){xe-=1,0==xe&&(xe=20),ke(),console.log("number of slide is",xe)})),y.addEventListener("change",(function(e){y.value=e.target.value,console.log("change city",y.value),localStorage.setItem("city",y.value),S(n.value)})),Le.addEventListener("click",(function(){var e;H+=180,(e=Le).style.transform=`rotate(${H}deg)`,e.style.transition="0.6s",T(n.value)})),f.addEventListener("click",(function(){$.src=q[C].src;const e=document.querySelectorAll(".play-item");k?($.pause(),k=!1,f.classList.toggle("pause"),e[C].classList.remove("active")):(E(),f.classList.toggle("pause"),e[C].classList.add("active"))})),L.addEventListener("click",b),w.addEventListener("click",(function(){const e=document.querySelectorAll(".play-item");e.forEach((e=>e.classList.remove("active"))),0==C?C=q.length-1:C-=1,$.src=q[C].src,e[C].classList.add("active"),E(),f.classList.contains("play")&&f.classList.add("pause")})),$.addEventListener("ended",b),D.addEventListener("click",(()=>{!function(e){var t;N.classList.toggle("open"),M+=180,(t=D).style.transform=`rotate(${M}deg)`,t.style.transition="0.6s",Se(),ve(e),console.log("timeset is",W.checked),pe()}(n.value)})),N.addEventListener("click",(()=>{Se(),pe()})),Te.addEventListener("click",(e=>{e.target.closest(".settings")||e.target.closest(".settings-button")||N.classList.remove("open"),e.target.closest(".todo")||e.target.closest(".todo-button")||A.classList.remove("open")})),O.addEventListener("click",(()=>{!function(t){var o;A.classList.toggle("open"),I+=180,(o=O).style.transform=`rotateY(${I}deg)`,o.style.transition="0.6s",P.textContent=`${e[t].activeTr}`,j.textContent=`${e[t].completedTr}`,_.textContent=`${e[t].deletedTr}`}(n.value)})),G.init(),U.addEventListener("change",(function(e){n.value=e.currentTarget.value,console.log("current language -",n.value),S(n.value),console.log("current city.value -",y.value),T(n.value),l(n.value),c(n.value),ve(n.value)}))})();